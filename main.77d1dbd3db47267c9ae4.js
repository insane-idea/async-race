(()=>{"use strict";var n=function(n,t,e,r){return new(e||(e=Promise))((function(i,a){function c(n){try{s(r.next(n))}catch(n){a(n)}}function o(n){try{s(r.throw(n))}catch(n){a(n)}}function s(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,o)}s((r=r.apply(n,t||[])).next())}))},t=function(n,t){var e,r,i,a,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;c;)try{if(e=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++,r=a[1],a=[0];continue;case 7:a=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){c=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){c.label=a[1];break}if(6===a[0]&&c.label<i[1]){c.label=i[1],i=a;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(a);break}i[2]&&c.ops.pop(),c.trys.pop();continue}a=t.call(n,c)}catch(n){a=[6,n],r=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};const e=function(){function e(n){this.server=n,this.garage="".concat(this.server,"/garage"),this.winners="".concat(this.server,"/winners"),this.engine="".concat(this.server,"/engine")}return e.prototype.getCars=function(e,r){return void 0===r&&(r=7),n(this,void 0,void 0,(function(){var n,i;return t(this,(function(t){switch(t.label){case 0:return[4,fetch("".concat(this.garage,"?_page=").concat(e,"&_limit=").concat(r))];case 1:return n=t.sent(),i={},[4,n.json()];case 2:return[2,(i.items=t.sent(),i.count=n.headers.get("X-Total-Count"),i)]}}))}))},e.prototype.getCar=function(e){return n(this,void 0,void 0,(function(){return t(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(this.garage,"/").concat(e))];case 1:return[2,n.sent().json()]}}))}))},e.prototype.createCar=function(e){return n(this,void 0,void 0,(function(){return t(this,(function(n){switch(n.label){case 0:return[4,fetch(this.garage,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})];case 1:return[2,n.sent().json()]}}))}))},e.prototype.deleteCar=function(e){return n(this,void 0,void 0,(function(){return t(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(this.garage,"/").concat(e),{method:"DELETE"})];case 1:return[2,n.sent().json()]}}))}))},e.prototype.updateCar=function(e,r){return n(this,void 0,void 0,(function(){return t(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(this.garage,"/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})];case 1:return[2,n.sent().json()]}}))}))},e.prototype.startEngine=function(e){return n(this,void 0,void 0,(function(){return t(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(this.engine,"?id=").concat(e,"&status=started"),{method:"PATCH"})];case 1:return[2,n.sent().json()]}}))}))},e.prototype.stopEngine=function(e){return n(this,void 0,void 0,(function(){return t(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(this.engine,"?id=").concat(e,"&status=stopped"),{method:"PATCH"})];case 1:return[2,n.sent().json()]}}))}))},e.prototype.switchDriveMode=function(e){return n(this,void 0,void 0,(function(){var n;return t(this,(function(t){switch(t.label){case 0:return[4,fetch("".concat(this.engine,"?id=").concat(e,"&status=drive"),{method:"PATCH"})];case 1:return[2,200===(n=t.sent()).status?n.json():{success:!1}]}}))}))},e.prototype.getWinners=function(e,r,i,a){return void 0===r&&(r=10),n(this,void 0,void 0,(function(){var n,c;return t(this,(function(t){switch(t.label){case 0:return[4,fetch("".concat(this.winners,"?_page=").concat(e,"&_limit=").concat(r,"&_sort=").concat(i,"&_order=").concat(a))];case 1:return n=t.sent(),c={},[4,n.json()];case 2:return[2,(c.items=t.sent(),c.count=n.headers.get("X-Total-Count"),c)]}}))}))},e.prototype.getWinner=function(e){return n(this,void 0,void 0,(function(){return t(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(this.winners,"/").concat(e))];case 1:return[2,n.sent().json()]}}))}))},e.prototype.createWinner=function(e){return n(this,void 0,void 0,(function(){return t(this,(function(n){switch(n.label){case 0:return[4,fetch(this.winners,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})];case 1:return[2,n.sent().json()]}}))}))},e.prototype.deleteWinner=function(e){return n(this,void 0,void 0,(function(){return t(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(this.winners,"/").concat(e),{method:"DELETE"})];case 1:return[2,n.sent().json()]}}))}))},e.prototype.updateWinner=function(e,r){return n(this,void 0,void 0,(function(){return t(this,(function(n){switch(n.label){case 0:return[4,fetch("".concat(this.winners,"/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})];case 1:return[2,n.sent().json()]}}))}))},e}(),r={viewPage:"garage",carsPageNum:1,winnersPageNum:1},i=["Audi","Alfa Romeo","Alpina","Aston Martin","Axon","Ford","Ferrari","Fiat","GAZ","GMC","Honda","Hummer","Hyundai","Infiniti","Isuzu","JAC","Jaguar","Jeep","Kamaz","Lada","Lexus","Lotus","MAN","Maybach","MAZ","Mazda","McLaren","Nissan","Opel","Paccar","Pagani","Pontiac","Porsche","Renault","Å koda","Smart","Subaru","Suzuki","Tesla","Toyota","UAZ","Volvo","ZAZ","XPeng","TVR","Saab","RAM","Chevrolet","Mazzanti","Daewoo"],a=["Roadster","S","X","3","Y","Cybertruck","X5","X7","X3","X6","GT4","FXX","599 GTO","Enzo","458 Italia","250 GTO","Priora","4x4","Rio","Focus","Kalina","Vesta","Spark","Lacetti","Nexia","Matiz","Cobalt","Captiva","A7","A5","A3","A8","TT","Corolla","Camry","RAV4","Impreza","WRX","ES","LS","RX","GX","LX","GS","LC500","Gallardo","Aventador","911","Cayenne","FX37"];var c=function(n,t,e,r){return new(e||(e=Promise))((function(i,a){function c(n){try{s(r.next(n))}catch(n){a(n)}}function o(n){try{s(r.throw(n))}catch(n){a(n)}}function s(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,o)}s((r=r.apply(n,t||[])).next())}))},o=function(n,t){var e,r,i,a,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;c;)try{if(e=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++,r=a[1],a=[0];continue;case 7:a=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){c=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){c.label=a[1];break}if(6===a[0]&&c.label<i[1]){c.label=i[1],i=a;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(a);break}i[2]&&c.ops.pop(),c.trys.pop();continue}a=t.call(n,c)}catch(n){a=[6,n],r=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};const s=function(){function n(){}return n.prototype.switchCarsPaginationButtons=function(){return c(this,void 0,void 0,(function(){var t,e;return o(this,(function(i){return t=document.querySelector(".prev-cars-page"),e=document.querySelector(".next-cars-page"),n.API.getCars(+r.carsPageNum+1).then((function(n){n.items.length>0?e.disabled=!1:e.disabled=!0,1===r.carsPageNum&&(t.disabled=!0)})),[2]}))}))},n.prototype.switchWinnersPaginationButtons=function(){return c(this,void 0,void 0,(function(){var t,e;return o(this,(function(i){return t=document.querySelector(".prev-winners-page"),e=document.querySelector(".next-winners-page"),n.API.getWinners(+r.winnersPageNum+1).then((function(n){n.items.length>0?e.disabled=!1:e.disabled=!0,1===r.winnersPageNum&&(t.disabled=!0)})),[2]}))}))},n.prototype.getRandomCarBody=function(){return c(this,void 0,void 0,(function(){return o(this,(function(n){return[2,{name:"".concat(i[this.getRandomInt(50)]," ").concat(a[this.getRandomInt(50)]),color:"#".concat(this.getRandomColor())}]}))}))},n.prototype.generateCar=function(){return c(this,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return[4,this.getRandomCarBody()];case 1:return t=e.sent(),[2,n.API.createCar(t)]}}))}))},n.prototype.generate100Cars=function(){return c(this,void 0,void 0,(function(){var n;return o(this,(function(t){for(n=100;n>0;)n-=1,this.generateCar();return[2]}))}))},n.prototype.getCoords=function(n){var t=n.getBoundingClientRect();return{left:t.left+window.scrollY,right:t.right+window.scrollY,top:t.top+window.scrollX,bottom:t.bottom+window.scrollY,width:t.right+window.scrollY-(t.left+window.scrollY),height:t.bottom+window.scrollY-(t.top+window.scrollX)}},n.prototype.getRandomInt=function(n){return Math.floor(Math.random()*n)},n.prototype.getRandomColor=function(){for(var n="";n.length<6;)n+="ABCDEF0123456789".charAt(this.getRandomInt(15));return n.toLowerCase()},n.API=new e("http://localhost:3000"),n}();var u=function(n,t,e,r){return new(e||(e=Promise))((function(i,a){function c(n){try{s(r.next(n))}catch(n){a(n)}}function o(n){try{s(r.throw(n))}catch(n){a(n)}}function s(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,o)}s((r=r.apply(n,t||[])).next())}))},l=function(n,t){var e,r,i,a,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;c;)try{if(e=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++,r=a[1],a=[0];continue;case 7:a=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){c=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){c.label=a[1];break}if(6===a[0]&&c.label<i[1]){c.label=i[1],i=a;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(a);break}i[2]&&c.ops.pop(),c.trys.pop();continue}a=t.call(n,c)}catch(n){a=[6,n],r=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};const d=function(){function n(){}return n.renderHTML=function(){return u(this,void 0,void 0,(function(){var n,t;return l(this,(function(e){return n=document.getElementById("main"),t=document.createElement("div"),n.innerHTML="",t.classList.add("container"),t.innerHTML='\n    <div class="controls">\n        <div class="form create-form">\n            <input type="text" class="create-name">\n            <input type="color" class="create-color" value="#d1c7c7">\n            <button class="create">Create</button>\n        </div>\n        <div class="form update-form">\n            <input type="text" class="update-name" disabled>\n            <input type="color" class="update-color" value="#d1c7c7" disabled>\n            <button class="update" disabled>Update</button>\n        </div>\n        <div class="cars-actions">\n            <button class="race">Race</button>\n            <button class="reset">Reset</button>\n            <button class="generate">Generate cars</button>\n        </div>\n    </div>\n\n    <div class="garage">\n        <h2 class="garage-header">Garage (<span class="cars-amount"></span>)</h2>\n        <h3 class="garage-page">Page #<span class="garage-page-num"></span></h3>\n\n        <div class="cars">\n\n        </div>\n    </div>\n    <div class="pagination">\n        <button class="prev-cars-page" data-id="prev">Prev</button>\n        <button class="next-cars-page" data-id="next">Next</button>\n    </div>\n',n.append(t),[2]}))}))},n.renderCars=function(t){return u(this,void 0,void 0,(function(){var e,i,a;return l(this,(function(c){switch(c.label){case 0:return e=document.querySelector(".cars"),i=document.querySelector(".cars-amount"),a=document.querySelector(".garage-page-num"),[4,n.API.getCars(t).then((function(n){return i.innerHTML=n.count.toString(),a.innerHTML=r.carsPageNum.toString(),n.items})).then((function(t){e.innerHTML="";var r=t.map((function(t){return n.drawCar(t,e)}));return Promise.all(r)}))];case 1:return c.sent(),[2]}}))}))},n.drawCar=function(t,e){return u(this,void 0,void 0,(function(){var r,i;return l(this,(function(a){return r='\n            <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 511 511"  xml:space="preserve">\n                <g>\n                    <path fill="'.concat(t.color.replace("#","%23"),'" d="M160,307.5h133.538c14.182,0,27.524-7.554,34.82-19.715l14.501-24.169c2.273-3.789,1.045-8.703-2.744-10.976 c-3.788-2.273-8.702-1.045-10.976,2.744l-14.501,24.169c-4.421,7.369-12.507,11.947-21.101,11.947H160c-4.418,0-8,3.582-8,8 S155.582,307.5,160,307.5z"/>\n\n                    <path fill="').concat(t.color.replace("#","%23"),'" d="M504,323.569V299.5c0-48.523-39.477-88-88-88h-44.209c-12.392-9.747-62.874-48-91.791-48h-54 c-11.001,0-21.904,1.664-32.403,4.945c-0.204,0.063-0.404,0.135-0.602,0.215l-73.691,29.675 c-11.071,3.427-22.56,5.165-34.152,5.165H58.687c-0.379-0.778-0.884-1.51-1.53-2.157l-7.772-7.772 C57.969,189.897,64,181.368,64,171.455V163.5c0-4.418-3.582-8-8-8H8c-4.418,0-8,3.582-8,8v7.955 C0,184.713,10.787,195.5,24.045,195.5h4.642l8,8h-6.685C17.87,203.5,8,213.37,8,225.502V291.5c0,18.508,13.298,34.094,33.88,39.714 C51.989,345.87,68.888,355.5,88,355.5c15.22,0,29.034-6.112,39.138-16h249.723c10.104,9.888,23.918,16,39.138,16 s29.034-6.112,39.138-16H503c4.418,0,8-3.582,8-8C511,327.421,507.945,324.062,504,323.569z M16,171.5h32 c-0.024,4.416-3.624,8-8.045,8h-15.91C19.624,179.5,16.024,175.916,16,171.5z M356.287,219.763 c-3.571,2.505-6.227,5.165-8.059,7.339l-150.98-14.465C204.31,199.968,218.975,179.5,240,179.5h40 C298.891,179.5,336.321,204.724,356.287,219.763z M24,291.5v-65.998c0-3.31,2.692-6.002,6.002-6.002h55.15 c13.317,0,26.514-2.014,39.225-5.986c0.204-0.063,0.404-0.135,0.602-0.215l73.433-29.571c-1.999,2.142-3.953,4.431-5.85,6.899 c-9.799,12.756-14.805,25.43-15.014,25.963c-0.913,2.336-0.677,4.965,0.638,7.102c1.314,2.136,3.554,3.533,6.051,3.772l167,16 c0.28,0.027,0.559,0.041,0.835,0.041c2.931,0,5.573-1.5,6.942-4.153c0.559-0.939,7.435-11.851,24.986-11.851h32 c39.701,0,72,32.299,72,72v24h-21.414c3.467-7.279,5.414-15.415,5.414-24c0-30.878-25.122-56-56-56s-56,25.122-56,56 c0,8.585,1.947,16.721,5.414,24H138.586c3.467-7.279,5.414-15.415,5.414-24c0-30.878-25.122-56-56-56s-56,25.122-56,56 c0,3.313,0.306,6.554,0.86,9.711C27.217,304.609,24,298.428,24,291.5z M48,299.5c0-22.056,17.944-40,40-40s40,17.944,40,40 s-17.944,40-40,40S48,321.556,48,299.5z M416,339.5c-22.056,0-40-17.944-40-40s17.944-40,40-40s40,17.944,40,40 S438.056,339.5,416,339.5z"/>\n\n                    <path fill="').concat(t.color.replace("#","%23"),'" d="M112,291.5c-4.418,0-8,3.582-8,8c0,8.822-7.178,16-16,16s-16-7.178-16-16s7.178-16,16-16c4.418,0,8-3.582,8-8s-3.582-8-8-8 c-17.645,0-32,14.355-32,32s14.355,32,32,32s32-14.355,32-32C120,295.082,116.418,291.5,112,291.5z"/>\n\n                    <path fill="').concat(t.color.replace("#","%23"),'" d="M440,291.5c-4.418,0-8,3.582-8,8c0,8.822-7.178,16-16,16s-16-7.178-16-16s7.178-16,16-16c4.418,0,8-3.582,8-8s-3.582-8-8-8 c-17.645,0-32,14.355-32,32s14.355,32,32,32s32-14.355,32-32C448,295.082,444.418,291.5,440,291.5z"/>\n                </g>\n            </svg>\n        '),(i=document.createElement("div")).classList.add("car"),i.dataset.id="".concat(t.id),i.innerHTML='\n            <div class="car-manage">\n                <button class="select-car">Select</button>\n                <button class="remove-car">Remove</button>\n                <span class="car-name">'.concat(t.name,'</span>\n            </div>\n            <div class="car-move">\n                <button class="start-car">A</button>\n                <button class="stop-car" disabled>B</button>\n                <div class="car-model">\n                    <img class="car-image" src=\'data:image/svg+xml;utf8,').concat(r,'\'>\n                </div>\n                <span class="finish-flag"></span>\n            </div>\n        '),e.append(i),document.querySelector(".create-name").value="",document.querySelector(".create-color").value=n.defaultInputColor,[2]}))}))},n.getGarageJSON=function(n){return u(this,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return[4,fetch(n)];case 1:return[2,t.sent().json()]}}))}))},n.createCar=function(){return u(this,void 0,void 0,(function(){var t,e,i;return l(this,(function(a){return t=document.querySelector(".create-name").value,e=document.querySelector(".create-color").value,t&&e&&(i={name:t,color:e},n.API.createCar(i).then((function(){return n.renderCars(r.carsPageNum)})).then((function(){return n.utils.switchCarsPaginationButtons()}))),[2]}))}))},n.carsListener=function(t){return u(this,void 0,void 0,(function(){function e(){var t={name:p.value,color:v.value};n.API.updateCar(f,t).then((function(){return n.renderCars(r.carsPageNum)})),p.disabled=!0,v.disabled=!0,g.disabled=!0,g.removeEventListener("click",e),setTimeout((function(){p.value="",v.value=n.defaultInputColor}),0)}function i(t){return u(this,void 0,void 0,(function(){return l(this,(function(e){return n.API.deleteCar(t).then((function(){return n.API.getWinner(t)})).then((function(t){t.id&&n.API.deleteWinner(t.id)})).finally((function(){n.renderCars(r.carsPageNum).then((function(){return n.utils.switchCarsPaginationButtons()}))})),[2]}))}))}function a(t,e){return u(this,void 0,void 0,(function(){return l(this,(function(r){return cancelAnimationFrame(t.animID),n.API.stopEngine(e),[2]}))}))}function c(t){return u(this,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return[4,n.API.startEngine(t).then((function(n){return function(n){var t=n.distance/n.velocity,e=null,r={animID:0};return r={animID:requestAnimationFrame((function n(i){b.disabled=!0,y.disabled=!1,e||(e=i);var a=(i-e)/t;a>1&&(a=1);var c=S+a*x;w.style.left="".concat(c,"px"),parseFloat(w.style.left)<S+x&&(r.animID=requestAnimationFrame(n))}))}}(n)})).then((function(e){y.addEventListener("click",(function(){!function(n,t){u(this,void 0,void 0,(function(){return l(this,(function(e){return a(n,t).then((function(){w.style.left="80px",b.disabled=!1,y.disabled=!0})),[2]}))}))}(e,t)})),n.API.switchDriveMode(t).then((function(n){n.success||a(e,t)}))})).catch((function(n){return console.log(n)}))];case 1:return e.sent(),[2]}}))}))}var o,s,d,h,f,p,v,g,w,m,b,y,C,P,S,x;return l(this,(function(r){switch(r.label){case 0:return o=t.target.classList.contains("remove-car"),s=t.target.classList.contains("select-car"),d=t.target.classList.contains("start-car"),h=t.target.parentElement.parentElement,f=+h.dataset.id,p=document.querySelector(".update-name"),v=document.querySelector(".update-color"),g=document.querySelector(".update"),w=h.querySelector(".car-model"),m=h.querySelector(".finish-flag"),b=h.querySelector(".start-car"),y=h.querySelector(".stop-car"),C=n.utils.getCoords(w).left,P=n.utils.getCoords(m).right,S=n.utils.getCoords(w).width,x=P-C,o?[4,i(f)]:[3,2];case 1:r.sent(),r.label=2;case 2:return s?[2,new Promise((function(t,r){t(n.getGarageJSON(n.API.garage).then((function(n){var t,r;r=f,t=n.find((function(n){return n.id===r})),p.disabled=!1,v.disabled=!1,g.disabled=!1,p.value=t.name,v.value=t.color,g.addEventListener("click",e)}))),r(new Error("Couldn't getGarageJSON or (dis/en)ableUpdateForm"))}))]:d?[4,c(f)]:[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},n.generateRandomCars=function(){return u(this,void 0,void 0,(function(){return l(this,(function(t){switch(t.label){case 0:return[4,n.utils.generate100Cars().then((function(){return n.renderCars(r.carsPageNum)})).then((function(){return n.utils.switchCarsPaginationButtons()}))];case 1:return t.sent(),[2]}}))}))},n.addListeners=function(){return u(this,void 0,void 0,(function(){var t,e,r;return l(this,(function(i){return t=document.querySelector(".cars"),e=document.querySelector(".create"),r=document.querySelector(".generate"),t.addEventListener("click",(function(t){return n.carsListener(t)})),e.addEventListener("click",n.createCar),r.addEventListener("click",n.generateRandomCars),[2]}))}))},n.prototype.carsPaginationListener=function(){return u(this,void 0,void 0,(function(){var t,e;return l(this,(function(i){return t=document.querySelector(".prev-cars-page"),e=document.querySelector(".next-cars-page"),t.addEventListener("click",(function(){t&&!t.disabled&&(r.carsPageNum=+r.carsPageNum-1,n.renderCars(r.carsPageNum).then((function(){return n.utils.switchCarsPaginationButtons()})))})),e.addEventListener("click",(function(){e&&!e.disabled&&(r.carsPageNum=+r.carsPageNum+1,n.renderCars(r.carsPageNum).then((function(){return n.utils.switchCarsPaginationButtons()}))),1===r.carsPageNum?t.disabled=!0:t.disabled=!1})),[2]}))}))},n.prototype.changePageNum=function(){return u(this,void 0,void 0,(function(){var t=this;return l(this,(function(e){switch(e.label){case 0:return document.querySelector(".cars")?[4,n.utils.switchCarsPaginationButtons().then((function(){t.carsPaginationListener()}))]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},n.prototype.run=function(){return u(this,void 0,void 0,(function(){var t=this;return l(this,(function(e){switch(e.label){case 0:return[4,n.renderHTML().then((function(){return n.renderCars(r.carsPageNum)})).then((function(){return n.addListeners()})).then((function(){return t.changePageNum()}))];case 1:return e.sent(),[2]}}))}))},n.defaultInputColor="#d1c7c7",n.API=new e("http://localhost:3000"),n.utils=new s,n}();var h=function(n,t,e,r){return new(e||(e=Promise))((function(i,a){function c(n){try{s(r.next(n))}catch(n){a(n)}}function o(n){try{s(r.throw(n))}catch(n){a(n)}}function s(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,o)}s((r=r.apply(n,t||[])).next())}))},f=function(n,t){var e,r,i,a,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;c;)try{if(e=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++,r=a[1],a=[0];continue;case 7:a=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){c=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){c.label=a[1];break}if(6===a[0]&&c.label<i[1]){c.label=i[1],i=a;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(a);break}i[2]&&c.ops.pop(),c.trys.pop();continue}a=t.call(n,c)}catch(n){a=[6,n],r=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};const p=function(){function n(){}return n.renderHTML=function(){return h(this,void 0,void 0,(function(){var n,t;return f(this,(function(e){return n=document.getElementById("main"),t=document.createElement("div"),n.innerHTML="",t.classList.add("container"),t.innerHTML='\n    <div class="headers">\n        <h2 class="winners-header">Winners (<span class="winners-amount"></span>)</h2>\n        <h3 class="winners-page">Page #<span class="winners-page-num"></span></h3>\n    </div>\n\n    <table class="winners-table">\n        <thead class="winners-table-header">\n            <tr class="winners-header-raw">\n                <th>Number</th>\n                <th>Car</th>\n                <th>Name</th>\n                <th>Wins</th>\n                <th>Best time, seconds</th>\n            </tr>\n        </thead>\n        <tbody class="winners-body">\n\n        </tbody>\n    </table>\n\n    <div class="pagination">\n        <button class="prev-winners-page" data-id="prev">Prev</button>\n        <button class="next-winners-page" data-id="next">Next</button>\n    </div>\n',n.append(t),[2]}))}))},n.getWinnersJSON=function(n){return h(this,void 0,void 0,(function(){return f(this,(function(t){switch(t.label){case 0:return[4,fetch(n)];case 1:return[2,t.sent().json()]}}))}))},n.renderWinners=function(t){return h(this,void 0,void 0,(function(){var e,i,a;return f(this,(function(c){switch(c.label){case 0:return e=document.querySelector(".winners-body"),i=document.querySelector(".winners-amount"),a=document.querySelector(".winners-page-num"),[4,n.API.getWinners(t,10,"id","ASC").then((function(n){return i.innerHTML=n.count.toString(),a.innerHTML=r.winnersPageNum.toString(),n.items})).then((function(t){if(e.innerHTML="",t.length>0){var r=t.map((function(t,e){return n.drawWinner(t,e)}));Promise.all(r)}})).then((function(){return n.utils.switchWinnersPaginationButtons()}))];case 1:return c.sent(),[2]}}))}))},n.drawWinner=function(t,e){return h(this,void 0,void 0,(function(){return f(this,(function(r){switch(r.label){case 0:return[4,n.API.getCar(t.id).then((function(n){if(n&&n.color){var r=document.querySelector(".winners-body"),i='\n                        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 511 511"  xml:space="preserve">\n                            <g>\n                                <path fill="'.concat(n.color.replace("#","%23"),'" d="M160,307.5h133.538c14.182,0,27.524-7.554,34.82-19.715l14.501-24.169c2.273-3.789,1.045-8.703-2.744-10.976 c-3.788-2.273-8.702-1.045-10.976,2.744l-14.501,24.169c-4.421,7.369-12.507,11.947-21.101,11.947H160c-4.418,0-8,3.582-8,8 S155.582,307.5,160,307.5z"/>\n\n                                <path fill="').concat(n.color.replace("#","%23"),'" d="M504,323.569V299.5c0-48.523-39.477-88-88-88h-44.209c-12.392-9.747-62.874-48-91.791-48h-54 c-11.001,0-21.904,1.664-32.403,4.945c-0.204,0.063-0.404,0.135-0.602,0.215l-73.691,29.675 c-11.071,3.427-22.56,5.165-34.152,5.165H58.687c-0.379-0.778-0.884-1.51-1.53-2.157l-7.772-7.772 C57.969,189.897,64,181.368,64,171.455V163.5c0-4.418-3.582-8-8-8H8c-4.418,0-8,3.582-8,8v7.955 C0,184.713,10.787,195.5,24.045,195.5h4.642l8,8h-6.685C17.87,203.5,8,213.37,8,225.502V291.5c0,18.508,13.298,34.094,33.88,39.714 C51.989,345.87,68.888,355.5,88,355.5c15.22,0,29.034-6.112,39.138-16h249.723c10.104,9.888,23.918,16,39.138,16 s29.034-6.112,39.138-16H503c4.418,0,8-3.582,8-8C511,327.421,507.945,324.062,504,323.569z M16,171.5h32 c-0.024,4.416-3.624,8-8.045,8h-15.91C19.624,179.5,16.024,175.916,16,171.5z M356.287,219.763 c-3.571,2.505-6.227,5.165-8.059,7.339l-150.98-14.465C204.31,199.968,218.975,179.5,240,179.5h40 C298.891,179.5,336.321,204.724,356.287,219.763z M24,291.5v-65.998c0-3.31,2.692-6.002,6.002-6.002h55.15 c13.317,0,26.514-2.014,39.225-5.986c0.204-0.063,0.404-0.135,0.602-0.215l73.433-29.571c-1.999,2.142-3.953,4.431-5.85,6.899 c-9.799,12.756-14.805,25.43-15.014,25.963c-0.913,2.336-0.677,4.965,0.638,7.102c1.314,2.136,3.554,3.533,6.051,3.772l167,16 c0.28,0.027,0.559,0.041,0.835,0.041c2.931,0,5.573-1.5,6.942-4.153c0.559-0.939,7.435-11.851,24.986-11.851h32 c39.701,0,72,32.299,72,72v24h-21.414c3.467-7.279,5.414-15.415,5.414-24c0-30.878-25.122-56-56-56s-56,25.122-56,56 c0,8.585,1.947,16.721,5.414,24H138.586c3.467-7.279,5.414-15.415,5.414-24c0-30.878-25.122-56-56-56s-56,25.122-56,56 c0,3.313,0.306,6.554,0.86,9.711C27.217,304.609,24,298.428,24,291.5z M48,299.5c0-22.056,17.944-40,40-40s40,17.944,40,40 s-17.944,40-40,40S48,321.556,48,299.5z M416,339.5c-22.056,0-40-17.944-40-40s17.944-40,40-40s40,17.944,40,40 S438.056,339.5,416,339.5z"/>\n\n                                <path fill="').concat(n.color.replace("#","%23"),'" d="M112,291.5c-4.418,0-8,3.582-8,8c0,8.822-7.178,16-16,16s-16-7.178-16-16s7.178-16,16-16c4.418,0,8-3.582,8-8s-3.582-8-8-8 c-17.645,0-32,14.355-32,32s14.355,32,32,32s32-14.355,32-32C120,295.082,116.418,291.5,112,291.5z"/>\n\n                                <path fill="').concat(n.color.replace("#","%23"),'" d="M440,291.5c-4.418,0-8,3.582-8,8c0,8.822-7.178,16-16,16s-16-7.178-16-16s7.178-16,16-16c4.418,0,8-3.582,8-8s-3.582-8-8-8 c-17.645,0-32,14.355-32,32s14.355,32,32,32s32-14.355,32-32C448,295.082,444.418,291.5,440,291.5z"/>\n                            </g>\n                        </svg>\n                    '),a=document.createElement("tr");a.classList.add("winner"),a.innerHTML='\n                        <td class="number">'.concat(e+1,'</td>\n                        <td class="icon">\n                            <img class="car-image" src=\'data:image/svg+xml;utf8,').concat(i,'\'>\n                        </td>\n                        <td class="name">').concat(n.name,'</td>\n                        <td class="wins-amount">').concat(t.wins,'</td>\n                        <td class="best-time">').concat(t.time,"</td>\n                    "),r.append(a)}}))];case 1:return r.sent(),[2]}}))}))},n.prototype.winnersPaginationListener=function(){return h(this,void 0,void 0,(function(){var t,e;return f(this,(function(i){return t=document.querySelector(".prev-winners-page"),e=document.querySelector(".next-winners-page"),t.addEventListener("click",(function(){t.disabled||(r.winnersPageNum=+r.winnersPageNum-1,n.renderWinners(r.winnersPageNum).then((function(){return n.utils.switchWinnersPaginationButtons()})))})),e.addEventListener("click",(function(){e.disabled?t.disabled=1===r.winnersPageNum:(r.winnersPageNum=+r.winnersPageNum+1,n.renderWinners(r.winnersPageNum).then((function(){return n.utils.switchWinnersPaginationButtons()})))})),[2]}))}))},n.prototype.changePageNum=function(){return h(this,void 0,void 0,(function(){var t=this;return f(this,(function(e){switch(e.label){case 0:return document.querySelector(".winners-table")?[4,n.utils.switchWinnersPaginationButtons().then((function(){t.winnersPaginationListener()}))]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},n.prototype.run=function(){return h(this,void 0,void 0,(function(){var t=this;return f(this,(function(e){switch(e.label){case 0:return[4,n.renderHTML().then((function(){return n.renderWinners(r.winnersPageNum)})).then((function(){return t.changePageNum()}))];case 1:return e.sent(),[2]}}))}))},n.API=new e("http://localhost:3000"),n.utils=new s,n}();var v=function(n,t,e,r){return new(e||(e=Promise))((function(i,a){function c(n){try{s(r.next(n))}catch(n){a(n)}}function o(n){try{s(r.throw(n))}catch(n){a(n)}}function s(n){var t;n.done?i(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,o)}s((r=r.apply(n,t||[])).next())}))},g=function(n,t){var e,r,i,a,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(e)throw new TypeError("Generator is already executing.");for(;c;)try{if(e=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++,r=a[1],a=[0];continue;case 7:a=c.ops.pop(),c.trys.pop();continue;default:if(!((i=(i=c.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){c=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){c.label=a[1];break}if(6===a[0]&&c.label<i[1]){c.label=i[1],i=a;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(a);break}i[2]&&c.ops.pop(),c.trys.pop();continue}a=t.call(n,c)}catch(n){a=[6,n],r=0}finally{e=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};(new(function(){function n(){this.garage=new d,this.winners=new p,this.utils=new s}return n.prototype.changeView=function(n){return v(this,void 0,void 0,(function(){return g(this,(function(t){switch(t.label){case 0:return"garage"!==n||"garage"===r.viewPage?[3,2]:[4,this.garage.run().then((function(){r.viewPage=n}))];case 1:t.sent(),t.label=2;case 2:return"winners"!==n||"winners"===r.viewPage?[3,4]:[4,this.winners.run().then((function(){r.viewPage=n}))];case 3:t.sent(),t.label=4;case 4:return[2]}}))}))},n.prototype.changeViewListener=function(){return v(this,void 0,void 0,(function(){var n,t,e=this;return g(this,(function(r){return n=document.querySelector(".to-garage"),t=document.querySelector(".to-winners"),n.addEventListener("click",(function(n){var t=n.target.dataset.id;e.changeView(t)})),t.addEventListener("click",(function(n){var t=n.target.dataset.id;e.changeView(t)})),[2]}))}))},n.prototype.run=function(){return v(this,void 0,void 0,(function(){var n=this;return g(this,(function(t){switch(t.label){case 0:return[4,this.garage.run().then((function(){return n.changeViewListener()}))];case 1:return t.sent(),[2]}}))}))},n.API=new e("http://localhost:3000"),n}())).run()})();